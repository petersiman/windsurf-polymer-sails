<dom-module id="add-item-form">
  <link rel="import" type="css" href="add-item-form.css">
  <template>
      <iron-ajax url="/csrfToken" last-response="{{token}}" auto></iron-ajax>
      <paper-dialog id="add-item-modal" modal>
        <h2>{{title}}</h2>
        <div class="card-content">
          <form is="iron-form" method="post" action="/advert/create" id="createItemForm">
            <input type="hidden" name="_csrf" value="{{token._csrf}}"/>
            <paper-input id="title" label="Title" name="title" value="{{advert.title}}"
                         autofocus required char-counter maxlength="30"></paper-input>
                         <br />
             <paper-dropdown-menu label="Typ inzerátu" name="advertType" toggles>
              <paper-listbox class="dropdown-content" selected="1">
                <paper-item value="sell">predám</paper-item>
                <paper-item value="buy">kúpim</paper-item>
                <paper-item value="give">darujem</paper-item>
              </paper-listbox>
            </paper-dropdown-menu>
            <br />
            <paper-dropdown-menu label="Kategória" name="advertCategory">
               <paper-listbox class="dropdown-content" selected="1">
                 <paper-item value="complete">komplet</paper-item>
                 <paper-item value="sail">plachta</paper-item>
                 <paper-item value="board">doska</paper-item>
                 <paper-item value="clothes">oblečení</paper-item>
                 <paper-item value="other">jiné</paper-item>
               </paper-listbox>
             </paper-dropdown-menu>
             <br />
             <paper-textarea label="Popis" id="advertBody" name="advertBody" value="{{advert.advertBody}}" required></paper-textarea>
             <br />
             <paper-input id="price" name="price" allowed-pattern="[0-9]" label="Price" value="{{advert.price}}" autofocus>
                <div suffix>Kc</div>
             </paper-input>
             <div class="buttons">
               <paper-button id="submit-btn" raised>Odeslat</paper-button>
               <paper-button dialog-confirm autofocus>Close</paper-button>
             </div>
          </form>
          <iron-request id="formSubmitXhr"></iron-request>

        </div>

      </paper-dialog>

    <paper-toast id="toast" text=""></paper-toast>
  </template>
  <script>
    function submit(event){

      // Polymer.dom(event).localTarget.parentElement.parentElement.submit();
    }
    Polymer({
      is: "add-item-form",
      properties : {
        advert: Object,
        title: {
          type: String,
          value: 'Add item'
        }
      },
      listeners: {
        'submit-btn.click': 'paperBtnSubmitListener'
      },
      paperBtnSubmitListener: function(e){
        console.log('Submit pressed!');
        var form = this.$.createItemForm;
        console.log(form);
        this.$.formSubmitXhr.send({
          'url' : '/advert/create',
          'method' : 'post',
          'params' : new FormData(form)
        });
      }
    });
  </script>
</dom-module>
